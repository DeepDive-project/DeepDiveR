---
title: "reptilia"
output: html_document
date: "2024-09-26"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Prepping Input File

### Loading in Data

```{r load_packages}
library(DeepDiveR)
library(dplyr)
```

```{r}
data <- read.csv("C:/Users/SimoesLabAdmin/Documents/BDNN_Arielli/data/reptilia_processed_data/reptilia_deepdive_final.csv", header = TRUE, sep = ",")
head(data)
```

Checking if there are nulls

```{r}
data$Area[is.na(data$Area)]
```

```{r}
anyNA(data)
```

### Defining time bins by stages

```{r}
bins <- c(max(data$MaxAge),290.1, 283.5, 273, 264.3, 259.5, 252, 247, 242, 237, 227, 217)

bins
```

```{r}
range(data$MaxAge)
range(data$MinAge)

```

As you can see, the lowest bin does not include our lowest MinAge. So I added 199.3 to corresponmd to the Hettangian-Sinemurian border

```{r}
bins <- c(max(data$MaxAge),290.1, 283.5, 273, 264.3, 259.5, 252, 247, 242, 237, 227, 217, 199.3)

bins
```

### Combining into an Input File

```{r create_data, eval = FALSE}
# Create input file for DeepDive
prep_dd_input(
  # Specify occurrence data.frame
  dat = data,
  # Specify vector containing time bin boundaries
  bins = bins,
  # Specify number of replicates
  r = 100,
  # Specify name of created file
  output_file = "reptilia_deepdive_input.csv")

```

## Configuration File

Settings for the analysis

### Parameters for the simulations

```{r create_config}
# Create configuration file for DeepDive
config <- create_config(
  # Specify name for the simulations
  name = "reptilia_1",
  # Name of data file
  data_file = "reptilia_deepdive_input.csv",
  bins = bins,
  n_areas = as.integer(1)
  )
```

```{r}
edit_config(config = config,
            module = "general",
            parameter = "present_diversity", 
            value = 0)
edit_config(config = config,
            module = "general", 
            parameter = "wd",
            value = "reptilia")

# Default # of training sims = 10k, default test sims = 100

```

```{r}
# Write the config file
config$write("reptilia_config_1.ini")
```

## Running DeepDive

We will access the programs in the "deepdive" repo (not this repo) in order to run the simulations. The **Terminal** command:print(config$data$simulations\$carrying_capacity_multiplier)

```{python run, eval = FALSE}
python ../deepdive/run_dd_config.py reptilia/reptilia_config_1.ini -wd reptilia/
```

### Outputs:

-   

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
